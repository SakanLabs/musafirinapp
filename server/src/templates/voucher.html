<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Musafirin" />
  <title>Agent Hotel Voucher {{voucherNo}}</title>
  <style>
    /* ===== Base ===== */
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';line-height:1.3;color:#374151;background:#f9fafb;font-size:12px}
    .cs-container{max-width:800px;margin:20px auto;padding:20px;background:#fff;box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05);border-radius:8px}
    .cs-flex{display:flex}.cs-justify-between{justify-content:space-between}.cs-align-start{align-items:flex-start}.cs-align-center{align-items:center}
    .cs-text-right{text-align:right}.cs-text-center{text-align:center}
    .cs-mb-1{margin-bottom:3px}.cs-mb-2{margin-bottom:6px}.cs-mb-3{margin-bottom:9px}.cs-mb-4{margin-bottom:12px}.cs-mb-6{margin-bottom:16px}.cs-mb-8{margin-bottom:20px}.cs-mt-8{margin-top:20px}
    .cs-font-bold{font-weight:700}.cs-font-semibold{font-weight:600}
    .cs-text-xs{font-size:10px}.cs-text-sm{font-size:11px}.cs-text-lg{font-size:16px}.cs-text-xl{font-size:18px}.cs-text-2xl{font-size:20px}
    .cs-text-gray-500{color:#6b7280}.cs-text-gray-600{color:#4b5563}.cs-text-gray-800{color:#1f2937}
    .cs-badge{display:inline-block;padding:2px 6px;border-radius:999px;background:#eef2ff;color:#3730a3;font-weight:600;font-size:11px}
    .cs-chip{display:inline-block;padding:2px 8px;border-radius:6px;background:#ecfdf5;color:#065f46;font-weight:600;font-size:11px;border:1px solid #a7f3d0}
    .cs-chip.warn{background:#fff7ed;color:#9a3412;border-color:#fed7aa}
    .cs-divider{height:1px;background:#e5e7eb;margin:16px 0}
    .cs-list{margin:0;padding:0;list-style:none}
    .cs-list li{margin:0 0 4px 0}

    /* Cards */
    .cs-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px;padding:12px}
    .cs-card-compact{padding:6px 12px}
    .cs-info-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px;padding:14px;margin-top:12px}

    /* Tables */
    .cs-table{width:100%;border-collapse:collapse}
    .cs-table th,.cs-table td{padding:8px 0;text-align:left;vertical-align:top}
    .cs-table th{font-weight:700;color:#111827;border-bottom:1px solid #e5e7eb}
    .cs-table td{border-bottom:1px solid #f1f5f9}
    .cs-num{text-align:right;white-space:nowrap}
    .cs-muted{color:#6b7280}

    /* Print */
    @media print{
      body{background:#fff;font-size:11px}
      .cs-container{box-shadow:none;margin:0;padding:16px}
      .cs-no-print{display:none !important}
    }
  </style>
</head>
<body>
  <div class="cs-container">
    <!-- Header -->
    <div class="cs-flex cs-justify-between cs-align-start cs-mb-6">
      <div>
        <img src="data:image/png;base64,{{logoBase64}}" alt="{{brandName}} Logo" style="height:56px;width:auto;margin-bottom:6px">
        <div class="cs-text-xs cs-text-gray-500">{{brandTagline}}</div>
      </div>
      <div class="cs-text-right">
        <div class="cs-badge">Agent Hotel Voucher</div>
        <p class="cs-font-semibold cs-text-lg">#{{voucherNo}}</p>
        <p class="cs-text-gray-500">Issued: {{issueDate}}</p>
        <p class="cs-text-gray-800"><span class="cs-font-semibold">Status:</span>
          <span class="cs-chip {{#if isPayAtHotel}}warn{{/if}}">{{paymentType}}</span>
        </p>
        <!-- Hotel Confirmation Number (booking-level) -->
        <div class="cs-card cs-card-compact" style="display:inline-block;margin-top:6px; text-align:left">
          <p class="cs-text-xs cs-text-gray-500 cs-mb-1">Hotel Confirmation Number</p>
          <p class="cs-font-semibold">{{hotelConfirmationNo}}</p>
        </div>
      </div>
    </div>

    <!-- Hotel & Guest -->
    <div class="cs-flex cs-justify-between cs-align-start cs-mb-3">
      <div style="width:52%">
        <p class="cs-font-semibold cs-text-gray-800 cs-mb-1">Hotel</p>
        <div class="cs-card cs-card-compact">
          <p class="cs-font-semibold cs-mb-1">{{hotelName}}</p>
          <p class="cs-text-sm cs-text-gray-600">{{hotelAddress}}</p>
        </div>
      </div>
      <div style="width:44%" class="cs-text-right">
        <p class="cs-font-semibold cs-text-gray-800 cs-mb-1">Guest</p>
        <div class="cs-card cs-card-compact">
          <p class="cs-font-semibold cs-mb-1">{{leadGuest.name}}</p>
          <p class="cs-text-sm cs-text-gray-600">{{leadGuest.email}} <span class="cs-text-gray-500"> | </span> {{leadGuest.phone}}</p>
          {{#if guests}}
          <p class="cs-text-xs cs-text-gray-500 cs-mb-0">Additional Guests:</p>
          <ul class="cs-list cs-text-xs cs-text-gray-600">
            {{#each guests}}<li>{{this}}</li>{{/each}}
          </ul>
          {{/if}}
        </div>
      </div>
    </div>

    <!-- Stay Summary -->
    <div class="cs-card cs-flex cs-justify-between cs-align-start cs-mb-3">
      <div>
        <p class="cs-text-gray-600 cs-font-semibold cs-mb-1">Check-in</p>
        <p class="cs-font-semibold">{{checkIn}} <span class="cs-text-xs cs-muted">({{policyCheckInTime}})</span></p>
      </div>
      <div>
        <p class="cs-text-gray-600 cs-font-semibold cs-mb-1">Check-out</p>
        <p class="cs-font-semibold">{{checkOut}} <span class="cs-text-xs cs-muted">({{policyCheckOutTime}})</span></p>
      </div>
      <div>
        <p class="cs-text-gray-600 cs-font-semibold cs-mb-1">Total Nights</p>
        <p class="cs-font-semibold">{{nights}}</p>
      </div>
      <div>
        <p class="cs-text-gray-600 cs-font-semibold cs-mb-1">Rooms / Pax</p>
        <p class="cs-font-semibold">{{rooms}} rooms{{#if adults}} • {{adults}} Adults{{/if}}{{#if children}} • {{children}} Children{{/if}}</p>
      </div>
      <div>
        <p class="cs-text-gray-600 cs-font-semibold cs-mb-1">Confirmation</p>
        <p class="cs-font-semibold">Hotel Ref: {{hotelConfirmationNo}}</p>
      </div>
    </div>

    <!-- Room Details -->
    <div class="cs-mb-2">
      <h2 class="cs-text-lg cs-font-bold cs-text-gray-800 cs-mb-2">Room Details</h2>
      <table class="cs-table">
        <thead>
          <tr>
            <th style="width:40%">Room Type</th>
            <th style="width:20%">Meal Plan</th>
            <th style="width:15%" class="cs-text-center">Rooms</th>
            <th style="width:25%">Remarks</th>
          </tr>
        </thead>
        <tbody>
          {{#each roomsDetail}}
          <tr>
            <td class="cs-font-semibold">{{roomType}}</td>
            <td>{{mealPlan}}</td>
            <td class="cs-text-center">{{quantity}}</td>
            <td>{{remarks}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>

    <!-- Important Notes / Policies -->
    <div class="cs-info-card">
      <h3 class="cs-text-lg cs-font-bold cs-text-gray-800 cs-mb-2">Important Notes</h3>
      <ul class="cs-list cs-text-gray-600 cs-text-sm">
        <li>• This voucher must be presented at check-in, especially the Hotel Confirmation Number (HCN). Original ID may be required by the hotel.</li>
        <li>• Cancellation / no-show policy follows the hotel’s policy: {{cancellationPolicy}}.</li>
        {{#if specialRequest}}<li>• Special request: {{specialRequest}} (subject to availability).</li>{{/if}}
      </ul>
    </div>

    <!-- Support -->
    <div class="cs-flex cs-justify-between cs-align-start cs-mb-3 cs-mt-8">
      <div style="width:60%">
        <div class="cs-info-card">
          <p class="cs-font-semibold cs-text-gray-800 cs-mb-1">Support Contact</p>
          <p class="cs-text-sm cs-text-gray-600 cs-mb-1">{{brandName}} Support</p>
          <p class="cs-text-sm cs-text-gray-600 cs-mb-1">Email: {{supportEmail}} • WhatsApp: {{supportPhone}}</p>
          <p class="cs-text-xs cs-muted">Available 24/7 for check-in issues and emergency changes.</p>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="cs-divider"></div>
    <div class="cs-flex cs-justify-between cs-align-center">
      <p class="cs-text-sm cs-text-gray-500">Issued by {{brandName}} — {{brandWebsite}}</p>
      <button class="cs-no-print" onclick="window.print()" style="border:1px solid #e5e7eb;background:#fff;border-radius:6px;padding:6px 10px;cursor:pointer">Print</button>
    </div>
  </div>
</body>
</html>
